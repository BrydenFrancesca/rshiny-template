language: none

# node_js:
#   - #language version

# services:
#   - #any supported service

# env:
#   - #env1=foo
#   - #env2=bar

env:
  - secure: fCpAlPcvOp3i8eezCcKc7wce90KVLIw4tYq1VaYrg+ByVbycshGgKX0wMkxJxV5wGyZ0ZH2k0AuaCFCQzXbUPR+VhbQ8f3SaWNA4n+a46QtUmStWUtMEep04+ApinicbNoyU8snrwg2eqHAdwQWNEhvLSolXNI3xiogclBtRJn5zp4AYsjGVBcYElhyV5uGgOrRlUU9Lr8tDdDqCvtL04TEfIfX6MPcOnbAng8q8QVo+fRy6vqqYx6AqOFr798UzU0uiST2ZozsSaGUefWXvIndVf4+SPZ30C1uNdwFu1lQXqLgkwMJFq7FeLW4dU1/bDUyv4rWHsx4EotHsHaI7DA==

# matrix:

build:
  pre_ci_boot:
    image_name: ubuntu
    image_tag: 16.04
    pull: true
    options: "-e HOME=/root"

  ci:
    - docker build -t ${AWS_ACCOUNT_ID}.dkr.ecr.eu-west-1.amazonaws.com/${REPO_NAME}:$(echo ${COMMIT}| cut -c1-8) -t ${AWS_ACCOUNT_ID}.dkr.ecr.eu-west-1.amazonaws.com/${REPO_NAME}:latest .
  post_ci:
    - docker push ${AWS_ACCOUNT_ID}.dkr.ecr.eu-west-1.amazonaws.com/${REPO_NAME}:$(echo ${COMMIT}| cut -c1-8)
    - docker push ${AWS_ACCOUNT_ID}.dkr.ecr.eu-west-1.amazonaws.com/${REPO_NAME}:latest
  # on_success:
  #   - #command1
  #   - #command2
  # on_failure:
  #   - #command1
  #   - #command2
  # cache:
  # cache_dir_list:
  #   - #dir1
  # push:

# integrations:
#  notifications:
#    - integrationName:
#      type:
#      recipients:
#        - #recp1
#        - #recp2

  hub:
    - integrationName: ecr-integration
      type: ecr
      region: eu-west-1
      branches:
        only:
          - master
